xfreerdp /u:andy.dwyer /v:10.50.26.193 /dynamic-resolution +glyph-cache +clipboard ###Password is BurtMacklinFBI
CTFd Account SESA-M-005 PW: SESA005
ssh -J andy.dwyer@10.50.26.193 




DAY 1 ###POWERSHELL,PROFILES< AND REMOTING###
Get-Verb ### gets all verbs 
Get-Command -type cmdlet |  | sort-object -property noun | format -groupby noun ### shows all commands formatted by noun
Get-Help get-process ### shows all available help for that command 
set-alias -name IP -Value get-netipaddress ### grabs local host IPs and network information
Methods are things you can take action on, Properties are something you can take information from
get-process | select-object name,id,path | ft ### grabs information from services and formats by name, ID and path
get-process | select-object name,id,path | where-object {$_.id -lt '1000'} ### grabs objects with id less then 1000
Get-CimInstance -classname win32_logicaldisk





get-ciminstance -classname win32_logicaldisk -filter "drivetype=3" | Get-Member
Get-WmiObject -class win32_logicaldisk -filter "drivetype=3"
Get-CimInstance -class Win32_BIOS ### Shows BIOS information
###DO (WHILE OR UNTIL) 
###FOR(ITERATES THROUGH A LIST UNTIL NOT TRUE)
###FOREACH(GOES THROUGH MULTIPLE ARRAYS ?
###IF ELSE(IF CONDITION DO THIS ELSE THIS)
###
Get-ExecutionPolicy -list ###shows security for the machine 
Set-ExecutionPolicy ###how to set the execution policy 
Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope CurrentUser ### changes ExecutionPolicy to unrestricted on currentuser
Get-PSSessionConfiguration 
###Powershell remoting is enabled by default
Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\'###
winrm get winrm/config ### gets information for winrm
Get-Item WSMan:\localhost\Client\TrustedHosts
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "file-server,domain-controll"
invoke-command -ComputerName file-server {Get-Service}
invoke-command -ComputerName file-server,domain-controll {Get-Service} -asjob
Receive-Job 2
$Session = NewPSSession -Computername File-Server
Enter-PSSession -Session $Session
Invoke-Command -Session $Session {Get-Service}
test-path -Path $profile.CurrentUserCurrentHost
test-path -Path $profile.CurrentUserAllHost
test-path -Path $profile.AllUserCurrentHost
test-path -Path $profile.AllUserAllHost
$profile | Get-Member -type NoteProperty
New-Item -itemtype file -path $profile -force ###profile it reads from in powershell start up



ls 'C:\Users\CTF\Desktop\ctf'

cd C:\Users\CTF\Videos\
(dir).count
or
Get-Childitem -File C:\Users\CTF\Videos\ | Measure-Object

cd C:\Users\CTF\Downloads
ls
or

Compare-Object (gc .\new.txt) (gc \old.txt)

(get-content .\words.txt | Sort-Object -Descending) | select -First 21

Get-Content .\words.txt | sort | unique | Measure-Object

gci | measure


usacys
UnitedStatesArmyCyberSchool

DAY 2 ### REGISTRY ###
regedit.exe , Located at C:\Windows\regedit.exe

get-item

SETHC.exe is a sticky key registry, you can establish persistance on it

New-PSDeive -Name HKU -PSProvider Registry -Root HKEY_USERS

Forensically Relevant keys 
-Internet URL history
-USB History
-Wireless accept point history
research anytime during baseline registry (Cont. on slides)

HKLM\BCD00000000
HKLM\SAM\SAM\

Baselining is comparing the customers Registry with a normal registry

HKLM has configurations for entire computer

HKCU resides in memory, will wipe after reset 

connecting by remote registry id det to deufakt si yiu can't do that

reg query hklm\software\microsoft\windows\currentversion\run

reg add hklm\software\microsoft\windows\currentversion\run /v testkey /t REG_SZ /d C:\Windows\system32\WindowsPowershell\v1.0\powershell.exe

reg delete hklm\software\microsoft\windows\currentversion\run /v testkey

 get-childitem get-itemproperty get-item ### to query registries

set-itemproperty remove-itemproperty ### to append items in key and delete item in key

new-item new-itemproperty ### 

 get-childitem HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\ ### Shows sub-keys but not values

get-item HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\ Shows values but not sub-keys 

Day 3 ### LINUX ###

which ### shows path of commands 
hostname ### shows name of the host on computer, shows which BOX you're on
whoami ### who is logged in right now 
who ### shows who is all logged in on the machine 
ifconfig or ip config ###displays network interfaces and configured IP addresses 
arp or ip neigh ### see MAC Addresses on machines 
ip route or route ### Shows where packets are being routed to 
ss or netstat ### will show network connections or listening ports 
     -netstat -anop ### shows all network connections and executables with them
iptable ### shows firewall rules (you need admin permissions)
sudo !! ### runs previous commands with admin permissions
sudo -l ### shows what command a user can run with elevated permissions 
whereis ### locates binary, source and manual page files for the command that follows


Arguments ### Modify the functionallity of the base command to get desired results 
ls (--help) ### is an argument for a command to help the user understand command 

Variables and Command Substitution
echo $a ### trying to echo the variable a
directories=$(ls -lisa) ### the directories variable does an ls with -lisa options

Redirection
StandardInput = 0
StandardOutput = 1 
StandardError = 2 
Redirection is done with >(filename or numbered stream)
EX: ls coffee 2> error.txt

Piping 
standard output to standard input 

Automation 
For loops  
goes through items in a list until doesn't meet condition
If
Runs Statement until no longer true then goes to an else block
While
Execute statement until it is false 
will run infinitely

Linux Filesystems
/root 
/bin ### essential User commands
/sbin ### used for system maintance
/home ###
/etc ### SystemCofigs
/var ### Variable data
/boot ### everything pertaining to the proccess execpt config files 
/dev ### device files 
/lib ### kernel modules and shared libaries
/mnt ### generic points for mount devices 
/proc ### processes
obt/ ### softwate and packages from 
file ### shows you what type of file it is 

Linux Users
id ### shows uid,gid,groups
cat /etc/passwd | grep student ### gets the same as id
cat /etc/group | grep student ### shows the sudo group, gid values, members 
ls -lisa /bin/dd ### shows privileges for files with read, write, execute 
sticky bit ### removes the ability to delete files unless the user attempting is th owner of the file 
Special Permissions SUID and GUID allows only for the owning user or group to access the executable 

Day 4 

BIOS and UEFI Proccess is the same just different variations 
BIOS
-uses bootmgr
-OS Loader uses winload.exe or winresume.exe
UEFI
-uses bootmgrfw.efi
-OS Loader winload.efi or winresume.efi
Windows Pre-Boot and Boot Process 
POST -> BIOS or UEFI -> MBR or GUID Partition Table -> go to FG Study Guide for more info
System has the PID of 4
Windows 10 logon process -> FG Study Guide for more info
BCDEDIT allows for user to edit BOOT Configuration
Firmware is the middleground between Boot process and system, is non-voliatile 
HAL is a layer between kernel and Hardware 
bcdedit /export C:\Lion_BCD grabs backup of bcdedit and puts it into C Drive 
bcdedit /set {current} 
bcdedit /create {ntldr} /d "Windows" 
bcdedit /display
bcdedit /deletevalue 
bcdedit /import
bcdedit /delete

Going to bad previous config
Windows Initalizing services 
System reverting to bad conf

Day 5 Linux Startup

Big Mike Got Killed In Russia (SYSV)
BIOS
MBR -located-> GRUB
KERNEL -> INIT with PID #1
Run Level 

BIOS
- First thing to turn on 
- preforms integrity checks 
- starts MBR
MBR (Master Boot Record)
- starts GRUB
- First 512 bytes of Harddrive 
- Has a Max of 4 primary partitions and a max size of 2TB
- located in /dev/hda or /dev/sda 
Commands du, df, lsblk
GRUB (Grand Unified Bootloader) 
Possible Area for an Attacker to put persistance 
- Config.file FGStudentGuide
Kernel
Layer between Hardware and OS
- executes /sbin/init or systemd daemon
- ls -l /sbin/init
Init
Configures the environment for the system
- looks at the /etc/inittab
- Available run levels 0 - 6
- entire process is handled by scripts in /etc/init.d/ or systemctl get-default list-dependencies 
Levels for Init.d
0 off
1 single user commandline
2 multi user witout networking 
3 full multiuser with networking 
4 
5 Graphical Target
6 
-Systemd Load system in parallel and from binaries (faster and more secure then init)
### If something is running something other than initd probably malicious or worth investigating 
Logs are stored in the /var directory 

Commands 
/etc/environment holds global variables ( have to reset when updated and can be used by all users ) 
/etc/profile logs when user uses an interactive shell in linux ( able to put persistance )
.bashprofile (does something) are in home directory

sudo dmidecode -t bios (looks if machine is either BIOS or UEFI)
lsblk (looks through storage devices)
sudo xxd -l 512 -g 1 /dev/vda (looks at the MBR) ### start of the drive EB 63

you can tell if it is systemV or SysD with cat /etc/inittab

xxd for hash dumps
dd gives a bit for bit copy ##creates copy of backup drive

ls -l show symbolic links in files/directories 

Day 5 
process validity is to VAILIDATE if a process is what it says it is 
serivces are exacutables that run in the backround of windows ( no user interaction ) 
- get-process SMSS,CSRSS,LSASS | sort -property id
- Get-Process | select Name, Id, Description | Sort -Property Id 
system processes and services run in C:\Windows\System32 by default 
- Get-Process | select name, priortiyclass
- Get-Process chrome | foreach {$a} {$_.modules} | more
- Get-Process "*chrome*" | select-object -ExpandProperty modules | more
- Get-Process "*chrome*" | select-object -ExpandProperty modules | Where-Object modulename -like '*chrome*' | more ( grabs all .dll with the name chrome )
- Get-CimInstance Win32_process
- Get-CimInstance Win32_Process | select name, processid, Parentprocessid gets name 
- Get-CimInstance Win32_Service | select name, processid, Pathname | ft -wrap | more
- Get-service XblGameSave | format-list *
- Get-service | where-object { $_.status -eq "Running" }
- Get-ScheduledTask | select * | select -First 1
Command Prompt
tasklist (Shows process) -v (shows more information about process)
tasklist -m (shows process and .dlls )
tasklist -m -fi 
tasklist /fo:list
tasklist /fo:csv

sc queryex type=service | more
sc queryex type=service state=inactive

Users account control 
Registry key for UAC is "HKLM\SOFTWARE\Microsoft\Windows|CurrentVersion\Policies|system"
Colors for UAC 
Red - Application or pubblisher blocked by policy group 
Blue - 
Yelow - 
Different Permission levels for UAC ( requireAdministrator, asInvoker, highestAvailable ) ###Some windows applications can auto-elevate

SysInternals 
Procmon shows realtime process 
procex
TCPView 
psloggedon (shows users currently logged on)
logonsessions (?)
pslist (cmd tool for getting process information)
psinfo (cmd tool gathers key information about system) 
.\pslist.exe -s 15 -r 1

Day 6
kthreadd always PID #2
/sbin/init always PID #1
The Kernel process runs in its own memory space making it more secure 
system calls ### process make calls to the kernel 

Orphans and Zombies (Go to FG)

- Daemons are programs that run in the background as processes
- All daemons are Orphans ,but not all orphans are Daemons
- Daemons purpose is to manage/monitor a service: {status, start, restart}

Job control 
- jobs display List of jobs running in the background
- a system cronjob it is running from /etc/crontab 
- if a user is running a cronjob it will run from /var/spool/cron/crontabs/
### cron jobs are scheduled task and is it a form of prediction










